block content
    div(id="live-chat")
        header(class="clearfix")
            a(href="#", class="chat-close") x

            h4(class="chat-box-name") Ema Barac

            span(class="chat-message-counter") 3

        div(class="chat")
            
            div(class="chat-history")
                
                div(class="chat-message clearfix")
                    
                    img(class="chat-image", src="http://lorempixum.com/32/32/people", alt="", width="32", height="32")

                    div(class="chat-message-content clearfix")
                        
                        span(class="chat-time") 13:35

                        h5(class="chat-message-name") Ema Barac

                        p(class="chat-p") Am înteles că un om poate avea totul neavand nimic și nimic având totul.
                hr(class="chat-hr")

                div(class="chat-message clearfix")
                    
                    img(class="chat-image" src="http://gravatar.com/avatar/2c0ad52fc5943b78d6abe069cc08f320?s=32" alt="" width="32" height="32")

                    div(class="chat-message-content clearfix")
                        
                        span(class="chat-time") 13:37

                        h5(class="chat-message-name") Emanuel Barac

                        p(class="chat-p") Întreaga apă din mare nu poate scufunda un vapor, dacă nu pătrunde în interiorul navei. În mod similar negativitatea din lume nu te poate pune jos, decât dacă îi permiți să ajungă în tine.

                hr(class="chat-hr")

                div(class="chat-message clearfix")
                    
                    img(class="chat-image" src="http://lorempixum.com/32/32/people" alt="" width="32" height="32")

                    div(class="chat-message-content clearfix")
                        
                        span(class="chat-time") 13:38

                        h5(class="chat-message-name") Ema Barac

                        p(class="chat-p") Da, asa este. Cata dreptate ai.

                hr(class="chat-hr")

            p(class="chat-feedback") Your partner is typing…

            form(action="#" method="post")

                fieldset(class="chat-fieldset")
                    
                    input(class="chat-input" type="text" placeholder="Type your message…" autofocus)
                    input(class="chat-input" type="hidden")
block javascript
    script(src="assets/js/main.js")
    script(type="text/javascript").
        $(document).ready(function() {

            $('#live-chat header').on('click', function() {

                $('.chat').slideToggle(300, 'swing');
                $('.chat-message-counter').fadeToggle(300, 'swing');

            });

            $('.chat-close').on('click', function(e) {

                e.preventDefault();
                $('#live-chat').fadeOut(300);

            });

            $('.chat-input').on("keypress", function(e) {
                if (e.keyCode == 13) {
                    var senderUsername = $('.chat-message-name').val().toString();
                    var receiverUsername = $('.chat-message-name').val().toString(); 
                    var payload = {
                        "senderUsername": "emabarac",    
                        "receiverUsername": "emabarac",
                        "timestamp": new Date(),    
                        "message": $('.chat-input').val().toString()
                        };
                    $.ajax({
                url: "http://localhost:8080/messages",
                type: "POST",
                dataType: "text",
                headers: {'Content-Type': 'application/json'},
                data: JSON.stringify(payload),
                success: function (data, textStatus, jqXHR) {
                    sessionStorage.setItem("accessToken",data);
                    alert('Success: ' + sessionStorage.accessToken);
                    window.location.href='cursuri.html';
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert('Error: ' + errorThrown);
                }
            });

                $.ajax({
                url: "http://localhost:8080/messages/" + "emabarac/" + "emabarac",
                type: "POST",
                dataType: "text",
                headers: {'Content-Type': 'application/json', 'token':},
                data: JSON.stringify(payload),
                success: function (data, textStatus, jqXHR) {
                    alert(data);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert('Error: ' + errorThrown);
                }
            });

            }    
            });});